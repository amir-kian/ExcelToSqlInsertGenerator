<Window x:Class="ExcelToSqlInsertGenerator.MainWindow"
        x:Name="RootWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ExcelToSqlInsertGenerator"
        mc:Ignorable="d"
        Title="Excel to SQL INSERT Generator" Height="700" Width="900"
        MinHeight="500" MinWidth="700">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="2*" MinHeight="120"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" MinHeight="150"/>
        </Grid.RowDefinitions>

        <!-- Step 1: Sample INSERT -->
        <GroupBox Grid.Row="0" Header="1. Sample INSERT statement" Margin="0,0,0,8">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="100"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Text="Paste your INSERT with placeholders like &lt;ColumnName, sql_type&gt; (e.g. &lt;Name, nvarchar(200)&gt;)" 
                          TextWrapping="Wrap" Margin="4" Foreground="#444"/>
                <TextBox x:Name="TxtInsertTemplate" Grid.Row="1" 
                         AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                         FontFamily="Consolas" FontSize="12" Padding="6"
                         Margin="4" VerticalContentAlignment="Top"/>
                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="4">
                    <Button x:Name="BtnParse" Content="Parse template" Click="BtnParse_Click" Padding="12,6" Margin="0,0,8,0"/>
                    <TextBlock x:Name="TxtParseStatus" VerticalAlignment="Center" Foreground="Gray"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Step 2: Excel file -->
        <GroupBox Grid.Row="1" Header="2. Excel file" Margin="0,0,0,8">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBox x:Name="TxtExcelPath" Grid.Column="0" IsReadOnly="True" Padding="6" Margin="4" VerticalContentAlignment="Center"/>
                    <Button x:Name="BtnLoadExcel" Grid.Column="1" Content="Browse..." Click="BtnLoadExcel_Click" Padding="12,6" Margin="4"/>
                </Grid>
                <ProgressBar x:Name="ExcelProgressBar" Grid.Row="1" Height="4" Margin="4,0" IsIndeterminate="True" Visibility="Collapsed"/>
                <TextBlock x:Name="TxtExcelStatus" Grid.Row="2" Margin="4" TextWrapping="Wrap" Visibility="Collapsed"
                           Foreground="#333" VerticalAlignment="Center"/>
            </Grid>
        </GroupBox>

        <!-- Step 3: Map INSERT values to Excel columns -->
        <GroupBox x:Name="GroupMapping" Grid.Row="2" Header="3. Map each INSERT value to an Excel column" Margin="0,0,0,8" Visibility="Collapsed">
            <DataGrid x:Name="GridMappings" AutoGenerateColumns="False" CanUserAddRows="False" 
                      HeadersVisibility="Column" Margin="4" MinHeight="100"
                      SelectionMode="Single" SelectionUnit="Cell">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="INSERT column" Binding="{Binding ColumnName}" Width="140" IsReadOnly="True"/>
                    <DataGridTextColumn Header="SQL type" Binding="{Binding SqlType}" Width="120" IsReadOnly="True"/>
                    <DataGridTemplateColumn Header="Source (Excel column or Custom)" Width="*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <ComboBox ItemsSource="{Binding MappingOptions, ElementName=RootWindow}"
                                          SelectedItem="{Binding SelectedExcelColumn, UpdateSourceTrigger=PropertyChanged}"
                                          IsEditable="False" Margin="2"
                                          ToolTip="Select an Excel column or '(Custom text)' to enter your own value"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                    <DataGridTemplateColumn Header="Custom text (when Source = Custom)" Width="*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Text="{Binding FixedValue, UpdateSourceTrigger=PropertyChanged}" 
                                         Margin="2"
                                         ToolTip="Enter SQL literal (e.g. GETDATE(), NEWID(), N'constant', NULL) when Source is Custom text"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- Generate -->
        <Grid Grid.Row="3" Margin="0,0,0,8">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <StackPanel Grid.Row="0" Orientation="Horizontal">
                <Button x:Name="BtnGenerate" Content="Generate INSERT script" Click="BtnGenerate_Click" Padding="14,8" Margin="0,0,8,0" IsEnabled="False"/>
                <Button x:Name="BtnCopy" Content="Copy to clipboard" Click="BtnCopy_Click" Padding="14,8" Margin="0,0,8,0" IsEnabled="False"/>
                <Button x:Name="BtnSave" Content="Save to file..." Click="BtnSave_Click" Padding="14,8" Margin="0,0,8,0" IsEnabled="False"/>
                <Button x:Name="BtnReset" Content="Reset" Click="BtnReset_Click" Padding="14,8" Margin="0,0,0,0" ToolTip="Clear mapping selections and generated SQL"/>
            </StackPanel>
            <ProgressBar x:Name="GenerateProgressBar" Grid.Row="1" Height="4" Margin="0,4,0,0" IsIndeterminate="True" Visibility="Collapsed"/>
            <TextBlock x:Name="TxtGenerateStatus" Grid.Row="2" Margin="0,4,0,0" TextWrapping="Wrap" Visibility="Collapsed"
                       Foreground="#333" VerticalAlignment="Center"/>
        </Grid>

        <!-- Output -->
        <GroupBox Grid.Row="4" Header="Generated SQL">
            <TextBox x:Name="TxtOutput" IsReadOnly="True" AcceptsReturn="True" TextWrapping="NoWrap" 
                     HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"
                     FontFamily="Consolas" FontSize="12" Padding="6"/>
        </GroupBox>
    </Grid>
</Window>
